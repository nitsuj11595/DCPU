;;; hello.dasm16
;;; Copyright 26XX (c) nitsuj11595
;;; 
;;; This file is part of clock
;;; Requires a Generic Clock and either a LEM or Pixie monitor 
;;; 
;;; This program is free software: you can redistribute it and/or modify
;;; it under the terms of the GNU General Public License as published by
;;; the Free Software Foundation, either version 3 of the License, or
;;; (at your option) any later version.
;;; 
;;; This program is distributed in the hope that it will be useful,
;;; but WITHOUT ANY WARRANTY; without even the implied warranty of
;;; MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
;;; GNU General Public License for more details.
;;; 
;;; You should have received a copy of the GNU General Public License
;;; along with this program.  If not, see <http://www.gnu.org/licenses/>.

:CLOCK_tick
;;; Redraw time
;;; Clobbered Registers: A, B, C, X, Y, Z
	SET	A, 0x0010
	HWI	[CLOCK]
	;; Draw year
	SET	[VIDEORAM_START+0x0000], B
	DIV	[VIDEORAM_START+0x0000], 1000
	ADD	[VIDEORAM_START+0x0000], 0xF030
	
	SET	[VIDEORAM_START+0x0001], B
	DIV	[VIDEORAM_START+0x0001], 100
	MOD	[VIDEORAM_START+0x0001], 10
	ADD	[VIDEORAM_START+0x0001], 0xF030

	SET	[VIDEORAM_START+0x0002], B
	DIV	[VIDEORAM_START+0x0002], 10
	MOD	[VIDEORAM_START+0x0002], 10
	ADD	[VIDEORAM_START+0x0002], 0xF030

	SET	[VIDEORAM_START+0x0003], B
	MOD	[VIDEORAM_START+0x0003], 10
	ADD	[VIDEORAM_START+0x0003], 0xF030
	
	SET	[VIDEORAM_START+0x0004], 0xF02D
	;; Draw Month
	SET	[VIDEORAM_START+0x0005], C
	SHR	[VIDEORAM_START+0x0005], 8
	DIV	[VIDEORAM_START+0x0005], 10
	MOD	[VIDEORAM_START+0x0005], 10
	ADD	[VIDEORAM_START+0x0005], 0xF030

	SET	[VIDEORAM_START+0x0006], C	
	SHR	[VIDEORAM_START+0x0006], 8
	MOD	[VIDEORAM_START+0x0006], 10
	ADD	[VIDEORAM_START+0x0006], 0xF030

	SET	[VIDEORAM_START+0x0007], 0xF02D
	;; Draw Day
	SET	[VIDEORAM_START+0x0008], C
	AND	[VIDEORAM_START+0x0008], 0x00FF
	DIV	[VIDEORAM_START+0x0008], 10
	MOD	[VIDEORAM_START+0x0008], 10
	ADD	[VIDEORAM_START+0x0008], 0xF030

	SET	[VIDEORAM_START+0x0009], C	
	AND	[VIDEORAM_START+0x0009], 0x00FF
	MOD	[VIDEORAM_START+0x0009], 10
	ADD	[VIDEORAM_START+0x0009], 0xF030

	;; SET	[VIDEORAM_START+0x000A], 0xF054
	;; Draw hour
	SET	[VIDEORAM_START+0x0020], X
	SHR	[VIDEORAM_START+0x0020], 8
	DIV	[VIDEORAM_START+0x0020], 10
	ADD	[VIDEORAM_START+0x0020], 0xF030
	
	SET	[VIDEORAM_START+0x0021], X
	SHR	[VIDEORAM_START+0x0021], 8
	MOD	[VIDEORAM_START+0x0021], 10
	ADD	[VIDEORAM_START+0x0021], 0xF030

	SET	[VIDEORAM_START+0x0022], 0xF03A
	;; Draw minute
	SET	[VIDEORAM_START+0x0023], X
	AND	[VIDEORAM_START+0x0023], 0x00FF
	DIV	[VIDEORAM_START+0x0023], 10
	ADD	[VIDEORAM_START+0x0023], 0xF030
	
	SET	[VIDEORAM_START+0x0024], X
	AND	[VIDEORAM_START+0x0024], 0x00FF
	MOD	[VIDEORAM_START+0x0024], 10
	ADD	[VIDEORAM_START+0x0024], 0xF030

	SET	[VIDEORAM_START+0x0025], 0xF03A
	;; Draw second
	SET	[VIDEORAM_START+0x0026], Y
	DIV	[VIDEORAM_START+0x0026], 10
	ADD	[VIDEORAM_START+0x0026], 0xF030

	SET	[VIDEORAM_START+0x0027], Y
	MOD	[VIDEORAM_START+0x0027], 10
	ADD	[VIDEORAM_START+0x0027], 0xF030

	SET	[VIDEORAM_START+0x0028], 0xF02E
	;; SET	[VIDEORAM_START+0x0013], 0xF05A
	SET	[VIDEORAM_START+0x0029], Z
	DIV	[VIDEORAM_START+0x0029], 100
	ADD	[VIDEORAM_START+0x0029], 0xF030

	SET	[VIDEORAM_START+0x002A], Z
	DIV	[VIDEORAM_START+0x002A], 10
	MOD	[VIDEORAM_START+0x002A], 10
	ADD	[VIDEORAM_START+0x002A], 0xF030

	SET	[VIDEORAM_START+0x002B], Z
	MOD	[VIDEORAM_START+0x002B], 10
	ADD	[VIDEORAM_START+0x002B], 0xF030

	
	RFI	0x0000
